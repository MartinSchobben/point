<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>IC-read • point</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="IC-read">
<meta property="og:description" content="point">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">point</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9002</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/IC-diagnostics.html">IC-diagnostics</a>
    </li>
    <li>
      <a href="../articles/IC-introduction.html">IC-introduction</a>
    </li>
    <li>
      <a href="../articles/IC-precision.html">IC-precision</a>
    </li>
    <li>
      <a href="../articles/IC-process.html">IC-process</a>
    </li>
    <li>
      <a href="../articles/IC-read.html">IC-read</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>IC-read</h1>
                        <h4 class="author">Martin Schobben</h4>
            
      
      
      <div class="hidden name"><code>IC-read.Rmd</code></div>

    </div>

    
    
<div id="reading-raw-ion-count-data" class="section level1">
<h1 class="hasAnchor">
<a href="#reading-raw-ion-count-data" class="anchor"></a>Reading Raw Ion Count Data</h1>
<p>The read functions are currently only supported for data generated by a <em>Cameca NanoSIMS 50L</em>. Raw ion count data and accompanying metadata is extracted and collated into a single <a href="https://cran.r-project.org/web/packages/tibble/vignettes/tibble.html">tibble</a> from text files with the extensions <em>.is_txt</em>, <em>.chk_is</em> and <em>.stat</em>, respectively. These files can usually be found in a single directory, which often constitute the analysis on a series of spots.</p>
<div id="nomenclature" class="section level2">
<h2 class="hasAnchor">
<a href="#nomenclature" class="anchor"></a>Nomenclature</h2>
<ul>
<li>Sample: sample of the true population</li>
<li>Analytical substrate: Physical sample measured during SIMS analysis</li>
<li>Event: single event of an ion hitting the detector</li>
<li>Measurement: single count cycle <span class="math inline">\(N_i\)</span>
</li>
<li>Analysis: <span class="math inline">\(n\)</span>-series of measurements <span class="math inline">\(N_{(i)} = M_j\)</span>
</li>
<li>Study: <span class="math inline">\(m\)</span>-series of analyses <span class="math inline">\(M_{(j)}\)</span>, constituting the different spots on the analytical substrate</li>
</ul>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">point</span>) <span class="co"># load package</span></pre></body></html></div>
<p>The following packages are used in the examples that follow.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>) <span class="co"># manipulating data</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>) <span class="co"># manipulating strings</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">polyaAeppli</span>) <span class="co"># Polya-Aeppli distribution</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">purrr</span>) <span class="co"># functional programming</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">tidyr</span>) <span class="co"># tidyr data</span></pre></body></html></div>
</div>
<div id="example-dataset" class="section level2">
<h2 class="hasAnchor">
<a href="#example-dataset" class="anchor"></a>Example dataset</h2>
<p>Two example datasets are bundled with this package:</p>
<ul>
<li>2018-01-19-GLENDON</li>
<li>2020-01-17-TREASURE</li>
</ul>
<p>Both datasets are generated with the <em>Cameca NanoSIMS 50L</em> at the Department of Earth Sciences at Utrecht University. The dataset with the suffix <em>GLENDON</em> contains ion count data on calcium carbonate rock (so-called glendonites) of Jurassic and Cretaceous age. The sampled substrate is a glendonite specimen (an authigenic carbonate) and a in-house reference (a belemnite rostra). Ion detection for 7 individual species was performed solely with electron multipliers (EM) with the main purpose of producing stable carbon isotope ratios (<sup>13</sup>C/<sup>12</sup>C). The dataset with the suffix <em>TREASURE</em> consists of ion count data on pyrite minerals collected in the Baltic Sea. These analysis targeted the <sup>34</sup>S/<sup>32</sup>S composition, where the heavy isotope was collected on an EM and the light isotope on a Faraday Cup (FC).</p>
<p>The example directories can be accessed with the function <code>point_example</code>.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="co"># Use point_example() to access the examples bundled with this package </span>

<span class="co"># If path is 'NULL', the example directories will be listed</span>
<span class="fu"><a href="../reference/point_example.html">point_example</a></span>()
<span class="co">#&gt; [1] "2018-01-19-GLENDON"</span>
<span class="co"># Accessing the example directory 2018-01-19-GLENDON</span>
<span class="fu"><a href="../reference/point_example.html">point_example</a></span>(<span class="st">"2018-01-19-GLENDON"</span>)
<span class="co">#&gt; [1] "/tmp/Rtmp1cQgoM/temp_libpathba16a8dffa5/point/extdata/2018-01-19-GLENDON"</span></pre></body></html></div>
</div>
<div id="extracting-raw-ion-count-data-and-associated-metadata" class="section level2">
<h2 class="hasAnchor">
<a href="#extracting-raw-ion-count-data-and-associated-metadata" class="anchor"></a>Extracting raw ion count data and associated metadata</h2>
<p>The function <code>read_IC</code> takes a single argument, which is a character string indicating the directory file name.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="../reference/read_IC.html">read_IC</a></span>(<span class="fu"><a href="../reference/point_example.html">point_example</a></span>(<span class="st">"2018-01-19-GLENDON"</span>))
<span class="co">#&gt; # A tibble: 558,138 x 27</span>
<span class="co">#&gt;    file.nm  t.rw  N.rw num.mt species.nm mass.mt det.mt tc.mt bfield.mt rad.mt</span>
<span class="co">#&gt;    &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt;  1 2018-0…  0.54 12040      1 12C             12 Tr1    0.191     1436.   311.</span>
<span class="co">#&gt;  2 2018-0…  1.08 11950      1 12C             12 Tr1    0.191     1436.   311.</span>
<span class="co">#&gt;  3 2018-0…  1.62 12100      1 12C             12 Tr1    0.191     1436.   311.</span>
<span class="co">#&gt;  4 2018-0…  2.16 11946      1 12C             12 Tr1    0.191     1436.   311.</span>
<span class="co">#&gt;  5 2018-0…  2.7  12178      1 12C             12 Tr1    0.191     1436.   311.</span>
<span class="co">#&gt;  6 2018-0…  3.24 12114      1 12C             12 Tr1    0.191     1436.   311.</span>
<span class="co">#&gt;  7 2018-0…  3.78 12147      1 12C             12 Tr1    0.191     1436.   311.</span>
<span class="co">#&gt;  8 2018-0…  4.32 12092      1 12C             12 Tr1    0.191     1436.   311.</span>
<span class="co">#&gt;  9 2018-0…  4.86 12024      1 12C             12 Tr1    0.191     1436.   311.</span>
<span class="co">#&gt; 10 2018-0…  5.4  12045      1 12C             12 Tr1    0.191     1436.   311.</span>
<span class="co">#&gt; # … with 558,128 more rows, and 17 more variables: sample.nm &lt;chr&gt;,</span>
<span class="co">#&gt; #   date &lt;dttm&gt;, presput.mt &lt;dbl&gt;, bl_num.mt &lt;dbl&gt;, meas_bl.mt &lt;dbl&gt;,</span>
<span class="co">#&gt; #   width_hor.mt &lt;dbl&gt;, width_ver.mt &lt;dbl&gt;, prim_cur_start.mt &lt;dbl&gt;,</span>
<span class="co">#&gt; #   prim_cur_after.mt &lt;dbl&gt;, rast_com.mt &lt;dbl&gt;, blank_rast.mt &lt;dbl&gt;,</span>
<span class="co">#&gt; #   n.rw &lt;dbl&gt;, det_type.mt &lt;chr&gt;, mean_PHD &lt;dbl&gt;, SD_PHD &lt;dbl&gt;, EMHV &lt;dbl&gt;,</span>
<span class="co">#&gt; #   bl.mt &lt;int&gt;</span></pre></body></html></div>
<p>This generates a tibble which includes;</p>
<ul>
<li>
<code>N.rw</code>: the individual measurement counts <span class="math inline">\(N_i\)</span>
</li>
<li>
<code>t.rw</code>: time increments of the measurements <span class="math inline">\(t_i\)</span>
</li>
<li>
<code>file.nm</code>: file name</li>
<li>
<code>ID</code>: unique identifier which links chemical species of a single analysis</li>
<li>
<code>bl.mt</code>: count block identifier</li>
</ul>
<p>The data is complemented with metadata of the associated analysis;</p>
<ul>
<li>
<code>num.mt</code>: measurement order in case of multiple chemical species</li>
<li>
<code>species.nm</code>: chemical species name</li>
<li>
<code>mass.mt</code>: mass measured</li>
<li>
<code>det.mt</code>: number of the detector trolley</li>
<li>
<code>tc.mt</code>: measurement time of a measurement blanked in seconds</li>
<li>
<code>rad.mt</code>: radius of the mass spectrometer</li>
<li>
<code>sample.nm</code>: the assigned sample name</li>
<li>
<code>data</code>: date of the analysis</li>
<li>
<code>presput.mt</code>: time allocated for presputtering of the analytical substrate in seconds</li>
<li>
<code>bl_num.mt</code>: block number</li>
<li>
<code>meas_bl.mt</code>: number of measurements per block</li>
<li>
<code>width_hor.mt</code>: horizontal Secondary Ion Beam Centering in Volts</li>
<li>
<code>width_ver.mt</code>: vertical Secondary Ion Beam Centering in Volts</li>
<li>
<code>prim_cur_start.mt</code>: Primary Ion Beam current in pico Ampere at the beginning of the analysis</li>
<li>
<code>prim_cur_after.mt</code>: Primary Ion Beam current in pico Ampere at the end of the analysis</li>
<li>
<code>rast_com.mt</code>: raster dimensions in micrometer</li>
<li>
<code>blank_rast.mt</code>: percentage of blanked raster</li>
<li>
<code>n.rw</code>: the total number of measurements <span class="math inline">\(n\)</span>
</li>
<li>
<code>det_type.mt</code>: the type of ion counting devise; Electron Multiplier (EM) or Faraday Cup (FC)</li>
</ul>
<p>In the case of EM usage for ion counting the metadate is complemented with;</p>
<ul>
<li>
<code>mean_PHD</code>: the mean pulse height amplitude in Volts to approximate the peak height distribution (PHD)</li>
<li>
<code>SD_PHD</code>: the standard deviation of pulse height amplitude in Volts to approximate the PHD</li>
<li>
<code>EMHV</code>: EM High Voltage</li>
</ul>
<p>In the case of FC usage for ion counting the metadate is complemented with;</p>
<ul>
<li>
<code>FC_start.mt</code>: FC background count before data acquisition</li>
<li>
<code>FC_after.mt</code>: FC background count after data acquisition</li>
</ul>
</div>
<div id="extracting-metadata-for-machine-performance-assessment" class="section level2">
<h2 class="hasAnchor">
<a href="#extracting-metadata-for-machine-performance-assessment" class="anchor"></a>Extracting metadata for machine performance assessment</h2>
<p>Alternatively, one can also only extract the metadata of an analysis to, e.g., assess machine performance over a sequence of analyses. For example, one can assess the Peak Height Distribution (PHD) over a series of analyses.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r">
<span class="no">tb.mt</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/read_IC.html">read_meta</a></span>(<span class="fu"><a href="../reference/point_example.html">point_example</a></span>(<span class="st">"2018-01-19-GLENDON"</span>))

<span class="co"># The polya density distribution model to approximate PHD distributions</span>
<span class="co"># install.packages("polyaAeppli")</span>

<span class="no">tb.mt</span> <span class="kw">&lt;-</span> <span class="no">tb.mt</span> <span class="kw">%&gt;%</span>
           <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span>(<span class="no">mean_PHD</span>, <span class="no">SD_PHD</span>) <span class="kw">%&gt;%</span>
           <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">species.nm</span> <span class="kw">==</span> <span class="st">"12C"</span>) <span class="kw">%&gt;%</span>  <span class="co"># most high intensity counts</span>
           <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">PHD</span> <span class="kw">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span>(<span class="no">mean_PHD</span>,
                                   ~<span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0</span>, <span class="fl">700</span>, <span class="kw">length</span> <span class="kw">=</span> <span class="fl">100</span>)))) <span class="kw">%&gt;%</span>
           <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">unnest</a></span>(<span class="kw">cols</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">PHD</span>)) <span class="kw">%&gt;%</span>
           <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">lambda</span> <span class="kw">=</span> (<span class="fl">2</span> * <span class="no">mean_PHD</span>^<span class="fl">2</span>) / (<span class="no">SD_PHD</span>^<span class="fl">2</span> + <span class="no">mean_PHD</span>),
                  <span class="kw">prob</span> <span class="kw">=</span> (<span class="no">SD_PHD</span>^<span class="fl">2</span> - <span class="no">mean_PHD</span>) / (<span class="no">SD_PHD</span>^<span class="fl">2</span> + <span class="no">mean_PHD</span>),
                  <span class="kw">prob</span> <span class="kw">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span>(<span class="no">prob</span> <span class="kw">&lt;</span> <span class="fl">0</span> <span class="kw">|</span> <span class="no">prob</span> <span class="kw">&gt;=</span> <span class="fl">1</span> , <span class="fl">NA_real_</span>, <span class="no">prob</span>),
                  ) <span class="kw">%&gt;%</span>
           <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span>(<span class="no">lambda</span>, <span class="no">prob</span>) <span class="kw">%&gt;%</span>
           <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">density</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/polyaAeppli/man/dPolyaAeppli.html">dPolyaAeppli</a></span>(<span class="no">PHD</span>,
                                         <span class="kw">lambda</span> <span class="kw">=</span> <span class="no">lambda</span>,
                                         <span class="kw">prob</span> <span class="kw">=</span> <span class="no">prob</span>),
                  <span class="kw">Y</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/polyaAeppli/man/dPolyaAeppli.html">pPolyaAeppli</a></span>(<span class="fl">50</span>,
                                  <span class="kw">lambda</span> <span class="kw">=</span> <span class="no">lambda</span>,
                                  <span class="kw">prob</span> <span class="kw">=</span> <span class="no">prob</span>,
                                  <span class="kw">lower.tail</span> <span class="kw">=</span> <span class="fl">FALSE</span>)) <span class="kw">%&gt;%</span>
           <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(<span class="no">file.nm</span>) <span class="kw">%&gt;%</span>
           <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">Yy</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="no">density</span>) * <span class="fl">0.8</span>) <span class="kw">%&gt;%</span>
           <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span>()

<span class="co"># Plot of PHD over analysis sequence</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">tb.mt</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">PHD</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">density</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>() +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fl">500</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">Yy</span>, <span class="kw">label</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"Y = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="no">Y</span>, <span class="fl">2</span>)))) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(<span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html">vars</a></span>(<span class="no">date</span>), <span class="kw">scales</span> <span class="kw">=</span> <span class="st">"free"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span>()</pre></body></html></div>
<div class="figure">
<img src="IC-read_files/figure-html/PHDexample-1.png" alt="The PHD with normalised units on the Y-axis approximated with the Polya-Aeppli density probability function with parameter $\lambda$ and $p$ for the location and shape of the curve. These parameters can be calculated using the metadata variables mean_PHD (mean) and SD_PHD (variance), which are compiled by the read_meta function." width="576"><p class="caption">
The PHD with normalised units on the Y-axis approximated with the Polya-Aeppli density probability function with parameter <span class="math inline">\(\lambda\)</span> and <span class="math inline">\(p\)</span> for the location and shape of the curve. These parameters can be calculated using the metadata variables mean_PHD (mean) and SD_PHD (variance), which are compiled by the read_meta function.
</p>
</div>
<p>The compounded Polya-Aeppli density probability function can approximate the peak height distribution <span class="citation">(Dietz 1970; Dietz and Hanrahan 1978)</span>. The package <code>pPolyaAeppli</code> <span class="citation">(Burden 2014)</span> together with the discriminator threshold value (usually 50 V) enables calculating the EM Yield (<span class="math inline">\(Y\)</span>) (Fig. @ref(fig:PHDexample)). More on this topic can be found in the vignette <a href="IC-process.html">IC-process</a>.</p>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-Burden2014">
<p>Burden, Conrad J. 2014. “An R Implementation of the Polya-Aeppli Distribution.” <a href="http://arxiv.org/abs/1406.2780">http://arxiv.org/abs/1406.2780</a>.</p>
</div>
<div id="ref-Dietz1970">
<p>Dietz, L. A. 1970. “General method for computing the statistics of charge amplification in particle and photon detectors used for pulse counting.” <em>International Journal of Mass Spectrometry and Ion Physics</em> 5 (1-2). Elsevier: 11–19. <a href="https://doi.org/10.1016/0020-7381(70)87002-4">https://doi.org/10.1016/0020-7381(70)87002-4</a>.</p>
</div>
<div id="ref-Dietz1978">
<p>Dietz, L. A., and L. R. Hanrahan. 1978. “Electron multiplier-scintillator detector for pulse counting positive or negative ions.” <em>Review of Scientific Instruments</em> 49 (9). American Institute of Physics: 1250–6. <a href="https://doi.org/10.1063/1.1135590">https://doi.org/10.1063/1.1135590</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Martin Schobben.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
