<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="point">
<title>IC-process • point</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="IC-process">
<meta property="og:description" content="point">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">point</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9003</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/IC-diagnostics.html">IC-diagnostics</a>
    <a class="dropdown-item" href="../articles/IC-introduction.html">IC-introduction</a>
    <a class="dropdown-item" href="../articles/IC-precision.html">IC-precision</a>
    <a class="dropdown-item" href="../articles/IC-process.html">IC-process</a>
    <a class="dropdown-item" href="../articles/IC-read.html">IC-read</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>IC-process</h1>
                        <h4 data-toc-skip class="author">Martin Schobben</h4>
            
      
      
      <div class="d-none name"><code>IC-process.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="accuracy-of-ion-count-data">
<span class="header-section-number">1</span> Accuracy of Ion Count Data<a class="anchor" aria-label="anchor" href="#accuracy-of-ion-count-data"></a>
</h2>
<p>Systematic bias can be introduced by the way secondary ions are generated from primary Cs<sup>+</sup> and O<sup>-</sup> bombardment on the analytical substrate as well as the <em>ion-to-electron conversion efficiency</em> in the detection systems. Commonly used detection system are electron multipliers (EM) for low secondary ion currents and Faraday cups (FC) for high secondary ion currents.</p>
<div class="section level3">
<h3 id="nomenclature">
<span class="header-section-number">1.1</span> Nomenclature<a class="anchor" aria-label="anchor" href="#nomenclature"></a>
</h3>
<ul>
<li>Sample: sample of the true population</li>
<li>Analytical substrate: physical sample measured during SIMS analysis</li>
<li>Event: single event of an ion hitting the detector</li>
<li>Measurement: single count cycle <span class="math inline">\(N_i\)</span>
</li>
<li>Analysis: <span class="math inline">\(n\)</span>-series of measurements <span class="math inline">\(N_{(i)} = M_j\)</span>
</li>
<li>Study: <span class="math inline">\(m\)</span>-series of analyses <span class="math inline">\(M_{(j)}\)</span>, constituting the different spots on the analytical substrate</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://martinschobben.github.io/point/">point</a></span><span class="op">)</span> <span class="co"># load package</span></code></pre></div>
<p>The following packages are used in the examples that follow.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span> <span class="co"># manipulating data</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span> <span class="co"># manipulating strings</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">polyaAeppli</span><span class="op">)</span> <span class="co"># Polya-Aeppli distribution</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span> <span class="co"># tibble dataframe</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="systematic-bias-by-ion-detection-devices">
<span class="header-section-number">1.2</span> Systematic bias by ion detection devices<a class="anchor" aria-label="anchor" href="#systematic-bias-by-ion-detection-devices"></a>
</h3>
<div class="section level4">
<h4 id="analytical-bias-introduced-by-electron-multipliers">
<span class="header-section-number">1.2.1</span> Analytical bias introduced by electron multipliers<a class="anchor" aria-label="anchor" href="#analytical-bias-introduced-by-electron-multipliers"></a>
</h4>
<p>The EM gain is a measure of the electron output current relative to the ion input and the amplification after ion-to-electron conversion. In this process an incident secondary ion triggers the generation of an electron at the first dynode (conversion dynode) of the EM channel; in turn, the resultant secondary electron strikes a consecutive dynode thereby amplifying the signal, where the latter process of secondary electron amplification is repeated multiple times (for the <em>Cameca NanoSIMS 50L</em> this generally results in a gain of <span class="math inline">\(10^8\)</span> electrons).</p>
<div class="figure">
<span style="display:block;" id="fig:EMdevice"></span>
<img src="../reference/figures/EM-channel.png" alt="Graphic representation of the EM ion detection device" width="80%"><p class="caption">
Figure 1.1: Graphic representation of the EM ion detection device
</p>
</div>
<p>After this phase of successive cascading charge amplification, the signal is converted to voltage (the EM high voltage, or EMHV; see Fig. <a href="#fig:EMdevice">1.1</a>), where the voltage is proportional to the EM gain. This last conversion depends on the age of the EM and the EMHV is usually increased with successive age to preserve ion-to-electron efficiency at a suitable sensitivity.</p>
<div class="section level5">
<h5 id="electron-multiplier-yield">
<span class="header-section-number">1.2.1.1</span> Electron Multiplier Yield<a class="anchor" aria-label="anchor" href="#electron-multiplier-yield"></a>
</h5>
<p>The amplitude of EM secondary electron output to EMHV conversion follows the so-called Peak Height Distribution (PHD). In tuning the EM detection system, the EM secondary electron output to EMHV conversion is optimized so that the probability of an electron output to have a certain EMHV is higher than a pre-defined threshold. This discriminator threshold is set to filter-out the background noise (typically 5<span class="math inline">\(\,\)</span>ct<span class="math inline">\(\,\)</span>s<sup>-</sup>). However the discriminator threshold will inevitably also cut-off part of the genuine EM secondary electron output <span class="citation">(Slodzian et al. 2001)</span>.</p>
<div class="figure">
<span style="display:block;" id="fig:PHDcurve"></span>
<img src="IC-process_files/figure-html/PHDcurve-1.png" alt="An example of a typical PHD distribution. The effect of the discriminator threshold on the EM Yield is examplified by the shaded area underneath the probability density function, which would pertain to the probability of an EM output to be larger than the threshold" width="672"><p class="caption">
Figure 1.2: An example of a typical PHD distribution. The effect of the discriminator threshold on the EM Yield is examplified by the shaded area underneath the probability density function, which would pertain to the probability of an EM output to be larger than the threshold
</p>
</div>
<p>This causes the true EM Yield <span class="math inline">\(Y_{EM}\)</span> to be smaller than 100% (see Fig. <a href="#fig:PHDcurve">1.2</a>). The PHD distribution adheres to the following principles:</p>
<ol style="list-style-type: decimal">
<li>Poisson statistics can account for the random processes involved in the initial generation of secondary ions (coupled to incident ions at the first dynode) and for each stage of successive multiplication by secondary electron generation at subsequent dynodes along the EM channel.</li>
<li>A geometric distribution describes the success of amplification at each dynode, which is independent and with identical probabilities at each dynode.</li>
<li>Successive stages of electron amplification results in a compounding of these random processes, but the shape of the PHD converges after the fourth or fifth stage of amplification <span class="citation">(Dietz and Hanrahan 1978)</span>.</li>
</ol>
<p>Given the previous points, the probability of the whole amplification process can be gauged by taking a geometric compounded Poisson (or Polya-Aeppli) random variable <span class="citation">(Dietz 1970; Dietz and Hanrahan 1978)</span>, which can be described by the following equation:</p>
<p><span class="math display" id="eq:PolyaAeppli">\[\begin{equation}

  P(x;\lambda, p) \; = \; \text{Pr}(X = x) \; =\\
   \begin{cases}
     e^{-\lambda}, &amp; \text{if } x = 0 \\ 
     e^{-\lambda}\sum_{n=1}^{y}{\frac{\lambda^n}{n!}}\binom{y-1}{n-1}p^{\lambda-n}(1-p)^n, &amp; \text{if } x = 1,2,... \\
   \end{cases}
  \tag{1.1}

\end{equation}\]</span></p>
<p>where <span class="math inline">\(\lambda\)</span> and <span class="math inline">\(p\)</span> determine, respectively, the location and the shape of the Polya-Aeppli probability distribution, see <span class="citation">Burden (2014)</span> for a full derivation of this equation and the associated parameters. Note, that the discriminator threshold causes <span class="math inline">\(x &gt; 0\)</span>. Furthermore, if <span class="math inline">\(p\)</span> = 0, the Polya-Aeppli probability distribution simplifies to a Poisson distribution.</p>
<p>The discriminator threshold value, the mean and variance of the measured PHD, can be used to calculate the probability that of successful ion-to-electron conversions before the analysis. This provides a means to get an accurate estimate of the true EM Yield (<span class="math inline">\(Y_{EM}\)</span>).</p>
<p>Th function <code>cor_yield</code> calculates the yield with a given mean (<code>mean_PHD</code>), standard deviation (<code>SD_PHD</code>), and threshold value for the PHD, and makes use of the package <code>pPolyaAeppli</code> <span class="citation">(Burden 2014)</span>.</p>
<p>The <span class="math inline">\(Y_{EM}\)</span> can then be used to calculate the corrected counts and count rates.</p>
<p><span class="math display" id="eq:Yield">\[\begin{equation}
  X_{i}^* = \frac{X_i }{Y_{EM}} 
  \tag{1.2}
\end{equation}\]</span></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># original count rate of a chemical species</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">30000</span>
<span class="co"># function to correct count rate based on EM Yield</span>
<span class="fu"><a href="../reference/cor_yield.html">cor_yield</a></span><span class="op">(</span><span class="va">x</span>, mean_PHD <span class="op">=</span> <span class="fl">210</span>, SD_PHD <span class="op">=</span> <span class="fl">60</span>, thr_PHD <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>
<span class="co">#&gt; [1] 30007.95</span></code></pre></div>
<p>The shape of the PHD distribution changes with the age of the EM but its deleterious effect on secondary ion-to-electron conversion can be alleviated by changing the EMHV. Tools for the assessment of EM deterioration is dealt with in a subsequent section.</p>
</div>
<div class="section level5">
<h5 id="dead-time">
<span class="header-section-number">1.2.1.2</span> Dead time<a class="anchor" aria-label="anchor" href="#dead-time"></a>
</h5>
<p>Another bias introduced by EM ion detection devices is the time associated for recovery after an ion hits the first dynode. During the intermediate time, a second ion arriving at the same time can then not be recorded because of the electronic paralysis of the EM. Although this dead time (<span class="math inline">\(t_{ns}\)</span>) is small (<span class="math inline">\(44\,\)</span>ns), high count frequencies can cause the cumulate effect of this re-occurring phenomenon to become significant for the final count numbers. The count rates can be corrected by the following equation:</p>
<p><span class="math display" id="eq:Dead">\[\begin{equation}
  X_{i}^{*} = \frac{X_i}{1- X_i  \times t_{ns} \times 10^9}
  \tag{1.3}
\end{equation}\]</span></p>
<p>The function <code>cor_DT</code> is implemented to correct for this systematic bias of EM devices.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># corrected count rate for a deadtime of 44 ns</span>
<span class="fu"><a href="../reference/cor_yield.html">cor_DT</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">44</span><span class="op">)</span>
<span class="co">#&gt; [1] 30039.65</span></code></pre></div>
<p>For a convenient workflow the functions that correct for EM count biases are wrapped in the function <code><a href="../reference/cor_IC.html">cor_IC()</a></code>. This function takes the <a href="https://cran.r-project.org/web/packages/tibble/vignettes/tibble.html" class="external-link">tibble</a> as loaded with the function <code><a href="../reference/read_IC.html">read_IC()</a></code> (see vignette <a href="IC-read.html">IC-read</a>) and requires setting the following arguments: <code>N</code>, a variable for the raw ion count;<code>t</code>, a variable for the time increments; <code>Det</code> a character string or variable identifying the ion detection system: EM (<code>"EM"</code>) or FC (<code>"FC"</code>); <code>deadtime</code>, a numeric value for the deadtime in nanoseconds; and <code>thr_PHD</code>, a numeric value for the discriminator threshold.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Use point_example() to access the examples bundled with this package </span>

<span class="co"># Carry-out the routine point workflow </span>

<span class="co"># Carry-out the routine point workflow</span>
<span class="co"># Raw data containing 13C and 12C counts on carbonate</span>
<span class="va">tb_rw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_IC.html">read_IC</a></span><span class="op">(</span><span class="fu"><a href="../reference/point_example.html">point_example</a></span><span class="op">(</span><span class="st">"2018-01-19-GLENDON"</span><span class="op">)</span>, meta <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># processing raw ion count data</span>
<span class="va">tb_pr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cor_IC.html">cor_IC</a></span><span class="op">(</span><span class="va">tb_rw</span><span class="op">)</span> </code></pre></div>
<p>The function returns the original tibble but adds the variables: <code>Xt.rw</code>, ion count rates uncorrected for detection device-specific biases; <code>Xt.pr</code>, ion count rates corrected for detection device-specific biases; and <code>N.pr</code>, counts corrected for detection device-specific biases.</p>
<!-- Next in line is another effect which relates to the source of the secondary ions. The efficiency by which an secondary ion is generated can vary dramatically per matrix, element and even isotope. As a result high secondary ion production can result instances where two ion are arriving simultaneously at the EM as the originate from the same primary ion impacting the substrate. Thereby representing a misrepresentation of the counts and skewed isotope values. This is especially relevant for the major ion in isotope analyses as the efficiency of secondary ion generation is higher, and the low probability of QSA becomes higher. This can be corrected by taking the average number of secondary ions ejected per primary ion, or efficiency (secondary ion generated : primary ions) : $K$, and by assuming Poisson statistics dictates the probability of QSA: -->
<!-- $$X_i^{***} = X_i^{**} \times (1+fK)$$ -->
<!-- , where $f$ is 0.5 based on Poisson statistics, BTU has been shown to vary among matrices. At this stage it is hard assess what $K$ could have been. -->
</div>
</div>
<div class="section level4">
<h4 id="analytical-bias-introduced-by-faraday-cups">
<span class="header-section-number">1.2.2</span> Analytical bias introduced by Faraday Cups<a class="anchor" aria-label="anchor" href="#analytical-bias-introduced-by-faraday-cups"></a>
</h4>
<p>To be included in the future.</p>
<!-- ## SIMS isotope calibration -->
<!-- Calibration of SIMS isotope measurements .. a twofold; 1) it enables inter-laboratory comparison .. 2) it corrects for isotope fractionation caused during secondary ion production and possibly ... (instrumental mass fractionation).  -->
<!-- ### The instrumental mass fractionation -->
<!-- The instrumental mass fractionation causes the isotopic composition of the ion current and signal registered to be distinctly different from the true isotopic composition of the analytical substrate. To accommodate for this often large discrepancy in the accuracy of SIMS isotope analyses, a standard with a known isotopic value is measured along with the samples of interest. With this standard the unknown isotopic composition of the sample can be calculated as follows: -->
<!-- $$ \delta = \left(\left[\frac{\bar{x}_R}{\bar{x}_{R_{std}}}  \right] \left( \delta_{std} + 1000  \right) \right) -1000 $$ -->
<!-- The isotopic composition of the standard is measured via traditional IRMS and posses it's own analytical uncertainty. Along with the precision achievable with the multiple count cycles of SIMS on the sample and standard this yield a cumulative uncertainty for each sample's isotopic measurement. The standard error of the isotope value that can account for both the SIMS and IRMS precision can be calculated by: -->
<!-- $$ s_{\delta_{\bar{x}}} = \sqrt{\left( \frac{ s_{\bar{x}_{R}} } { \bar{x}_R } \right)^2 + \left( \frac{ s_{\bar{x}_{R_{std}}}  } { \bar{x}_{R_{std}} } \right)^2 + \left( \frac{ s_{\delta_{std}} } { \delta_{std} +1000 } \right)^2} $$ -->
</div>
</div>
<div class="section level3">
<h3 id="systematic-bias-by-ionization-yield-fluctuations">
<span class="header-section-number">1.3</span> Systematic bias by ionization yield fluctuations<a class="anchor" aria-label="anchor" href="#systematic-bias-by-ionization-yield-fluctuations"></a>
</h3>
<p>In contrast to EM yield, ionization yield defines the efficiency whereby secondary ions are generated per incident primary ion. The probability whereby the primary beam produced secondary ions depends strongly on properties of the substrate (matrix effects) and the evolving sputter pit as well as the machine settings, such as the beam type (Cs<sup>+</sup> and O<sup>-</sup>) and sample charging. The latter effect of sample charge build-up combined with the deepening of the sputter pit are connected to large systematic biases seen in the count rates of individual ions (see Fig. <a href="#fig:ionR1">1.3</a>) throughout a single analysis <span class="citation">(Fitzsimons, Harte, and Clark 2000)</span>.</p>
<div class="figure">
<span style="display:block;" id="fig:ionR1"></span>
<img src="IC-process_files/figure-html/ionR1-1.png" alt="Changes in the ionization potential examplified by single ion monotonic trends in count rates over subsequent measurements of a single analysis with the NanoSIMS Cameca50L." width="768"><p class="caption">
Figure 1.3: Changes in the ionization potential examplified by single ion monotonic trends in count rates over subsequent measurements of a single analysis with the NanoSIMS Cameca50L.
</p>
</div>
<p>The systematic changes induced by ionization differences in count rate affect modulate count rates for both isotopes of the same equally (see Fig. <a href="#fig:ionR1">1.3</a>). From the <em>the formula for exact propagation of error</em> <span class="citation">(Ku 1966)</span> it can further be deduced that the error of co-variate ratios, such as for isotope ratios (<span class="math inline">\(R\)</span>), will effectively be dampened by the co-variate term in the equation (see vignette <a href="IC-precision.html">IC-precision</a>) and <span class="citation">Fitzsimons, Harte, and Clark (2000)</span>. However, this is not the case for none-isotope ion ratios and so their propagated error is also largely an effect of this systematic variance induced by ionization trends (see Fig. <a href="#fig:ionR2">1.4</a>).</p>
<div class="figure">
<span style="display:block;" id="fig:ionR2"></span>
<img src="IC-process_files/figure-html/ionR2-1.png" alt="Changes in the ratios of none-isotope and isotope ratios compared." width="768"><p class="caption">
Figure 1.4: Changes in the ratios of none-isotope and isotope ratios compared.
</p>
</div>
<p>Upon plotting the count rate ratios against time (Fig. <a href="#fig:ionR2">1.4</a>), it becomes apparent that the none-isotope ratios are affected by monotonic trends over the duration of the analysis. This effect reflects the differential ionization potentials and trajectories of secondary beam stabilization over the analysis (as explained above; Fig. <a href="#fig:ionR1">1.3</a>).</p>
<p><span class="math display" id="eq:components">\[\begin{equation}
  y_t = l_0 + T_t + P_t + \epsilon_t 
  \tag{1.4} 
\end{equation}\]</span></p>
<p>Time-series can be decomposed in several components (Eq. <a href="#eq:components">(1.4)</a>); the base level or mean of the time series; <span class="math inline">\(l0\)</span>, a structural trend component <span class="math inline">\(T_t\)</span> which change dependent on the time increment, a cyclical component <span class="math inline">\(P_t\)</span> and a noise component <span class="math inline">\(\epsilon_t\)</span>. Structural trends of a variable (i.e. count rates of species <span class="math inline">\(X_i^a\)</span>) based on the independent variable time (i.e. <span class="math inline">\(n\)</span>- series of measurements) can be described with regression analysis with the simplest implementation presented by the linear regression model:</p>
<p><span class="math display" id="eq:linreg">\[\begin{equation}
  \hat{y}_t = \beta_0 + \beta_1x_t + \epsilon_t
  \tag{1.5}
\end{equation}\]</span></p>
<p>The General Additive Model (GAM) is an extension of this model with addition of a smoothing function replacing the linear term of the previous function (Eq <a href="#eq:linreg">(1.5)</a>:</p>
<p><span class="math display" id="eq:GAM">\[\begin{equation}
  \hat{y}_t = \beta_0 + f(x_1) + \epsilon_t
  \tag{1.6}
\end{equation}\]</span></p>
<p>The function <code><a href="../reference/predict_ionize.html">predict_ionize()</a></code> provides a convenient implementation of GAM from the package <code>mgcv</code>, which has the function <code>s()</code>, to define the smooth function in the <code>gam()</code> call. The protocol implemented assures effective bandwidth selection based on goodness of fit measured with a penalized information criterion. With the knowledge that ionization is represented as global trend, this allows for subtraction of the model fit from the actual count rate data to allow for a more accurate assessment of the <span class="math inline">\(l0\)</span> as well as the random component <span class="math inline">\(\epsilon_t\)</span> informing about the precision unbiased by a large systematic offset.</p>
<p><span class="math display" id="eq:detr">\[\begin{equation}
  X_i^a* = \bar{\hat{X}}^a + (X_i^a - \hat{X}_i^a)
  \tag{1.7}
\end{equation}\]</span></p>
<p>The <code>point</code> package provides additional diagnostic tools to assess whether the model represents an under- or over-fit on the data (see vignette <a href="IC-diagnostics.html">IC-diagnostics</a>).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tb_dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_ionize.html">predict_ionize</a></span><span class="op">(</span><span class="va">tb_pr</span>, <span class="va">file.nm</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:ionR3"></span>
<img src="IC-process_files/figure-html/ionR3-1.png" alt="GAM predicted model fit (dashed black line) to single ion count rates and median count rate (solid blue line)." width="768"><p class="caption">
Figure 1.5: GAM predicted model fit (dashed black line) to single ion count rates and median count rate (solid blue line).
</p>
</div>
<div class="figure">
<span style="display:block;" id="fig:ionR4"></span>
<img src="IC-process_files/figure-html/ionR4-1.png" alt="An extraction of the $l0$ and $\epsilon_t$ components, by appliciation of Eq. \@ref(eq:detr), and thereby yielding corrected none-isotope ion count ratios." width="384"><p class="caption">
Figure 1.6: An extraction of the <span class="math inline">\(l0\)</span> and <span class="math inline">\(\epsilon_t\)</span> components, by appliciation of Eq. <a href="#eq:detr">(1.7)</a>, and thereby yielding corrected none-isotope ion count ratios.
</p>
</div>
<!-- ## Assessors of analytical drift -->
<!-- As the high counts of the heavy isotope accelerate the age process this effects should be obvious from the isotope rate over time. As such equation is a way to monitor over time: -->
<!-- $$ \delta_t = \frac{R_t - R_{t1}}{R_{t1} }\times 10^3 $$ -->
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references">
<div id="ref-Burden2014">
<p>Burden, Conrad J. 2014. “An R Implementation of the Polya-Aeppli Distribution.” <a href="http://arxiv.org/abs/1406.2780" class="external-link">http://arxiv.org/abs/1406.2780</a>.</p>
</div>
<div id="ref-Dietz1970">
<p>Dietz, L. A. 1970. “General method for computing the statistics of charge amplification in particle and photon detectors used for pulse counting.” <em>International Journal of Mass Spectrometry and Ion Physics</em> 5 (1-2): 11–19. <a href="https://doi.org/10.1016/0020-7381(70)87002-4" class="external-link">https://doi.org/10.1016/0020-7381(70)87002-4</a>.</p>
</div>
<div id="ref-Dietz1978">
<p>Dietz, L. A., and L. R. Hanrahan. 1978. “Electron multiplier-scintillator detector for pulse counting positive or negative ions.” <em>Review of Scientific Instruments</em> 49 (9): 1250–6. <a href="https://doi.org/10.1063/1.1135590" class="external-link">https://doi.org/10.1063/1.1135590</a>.</p>
</div>
<div id="ref-Fitzsimons2000a">
<p>Fitzsimons, I. C. W., B. Harte, and R. M. Clark. 2000. “SIMS stable isotope measurement: counting statistics and analytical precision.” <em>Mineralogical Magazine</em> 64 (01): 59–83. <a href="https://doi.org/10.1180/002646100549139" class="external-link">https://doi.org/10.1180/002646100549139</a>.</p>
</div>
<div id="ref-Ku1966">
<p>Ku, H. H. 1966. “Notes on the use of propagation of error formulas.” <em>Journal of Research of the National Bureau of Standards, Section C: Engineering and Instrumentation</em> 70C (4): 263. <a href="https://doi.org/10.6028/jres.070c.025" class="external-link">https://doi.org/10.6028/jres.070c.025</a>.</p>
</div>
<div id="ref-SLodzian2001">
<p>Slodzian, Georges, M Chaintreau, R Dennebouy, and A Rousse. 2001. “Precise in situ measurements of isotopic abundances with pulse.” <em>The European Physical Journal Applied Physics</em> 14: 199–231. <a href="https://doi.org/10.1051/epjap:2001160" class="external-link">https://doi.org/10.1051/epjap:2001160</a>.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Martin Schobben.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
